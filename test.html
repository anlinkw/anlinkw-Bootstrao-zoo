<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>新竹市公車資訊</title> 
	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="lib/css/bootstrap.min.css">
	<link rel="stylesheet" href="css/weather-API.css">
	<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css'>
	<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
	<style>
		#test h2{
			color: #1a67b1;
			text-align: center;
			border-bottom: 2px solid black;
			width: 25%;
			margin: 30px auto 50px;
		}
		table{
			text-align: center;
		}
		@media(max-width:768px) {
			#test h2{
				font-size: 22px;
				width: 60%;
			}
		}
	</style>
</head>
<body>
	<!-- 導覽列 -->
	<div class="container-fluid">
		<div class="row">
			<div class="col-sm-12 col-md-12 breadcrumb">
				<nav aria-label="breadcrumb" id="breadcrumb">
					<ol class="breadcrumb">
					  <li class="breadcrumb-item"><a href="index.html" data-toggle="tooltip" data-placement="bottom" title="新竹市立動物園"><i class="fas fa-home"></i>首頁</a></li>
					  <li class="breadcrumb-item active" aria-current="page">公車資訊</li>
					</ol>
				</nav>
			</div>
		</div>
	</div>

	<div id="test">
		<h2>市區公車路線班表資料</h2>
		<div class="container-fluid">
			<div class="row">
				<div id="busMap" class="col-12 col-sm-12 col-md-8 mr-auto ml-auto table-responsive-sm">
				</div> 
			</div>
		</div>
	</div>



	<script>
		function doFirst(){
			const weather = {};
			let busMap = document.getElementById('busMap');
			url="https://ptx.transportdata.tw/MOTC/v2/Bus/Schedule/City/Hsinchu?%24top=30&%24format=JSON";

			fetch(url)
			.then(function(response){
				return response.json();
			})
			.then(function(data){
				console.log(data[0].Timetables);					// 22
				console.log(data[0].Timetables[0].StopTimes[0]); 

				let busData = '<table class="table table-dark">';
					busData += `<th scope="col">ArrivalTime</th><th scope="col">DepartureTime</th><th scope="col">StopName</th>`;
				for(let i=0; i<data.length; i++){
					// busData += '<tr>';
						for(let j=0; j<data[i].Timetables.length; j++){
							busData += `<tr><td>
								到站時間: ${data[i].Timetables[j].StopTimes[0].ArrivalTime} <br>					
								</td>`;
							busData += `<td>
								出發時間: ${data[i].Timetables[j].StopTimes[0].DepartureTime} <br>
								</td>`;
							busData += `<td>
								站名: ${data[i].Timetables[j].StopTimes[0].StopName.Zh_tw} &nbsp;&nbsp;|&nbsp;&nbsp; ${data[i].Timetables[j].StopTimes[0].StopName.En}<br>
								</td></tr>`;
						}
					// busData += '</tr>';
				}
				busData += '</table>';
				busMap.innerHTML = busData;

			})

		}
		window.addEventListener('load',doFirst);
	</script>

	<!-- Boostrap JS -->
	<script src="lib/js/jquery-3.6.min.js"></script>
	<script src="lib/js/bootstrap.bundle.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
	<script src="lib/js/bootstrap.min.js"></script>

	<script>
		$(function () {
			//  header首頁 icon 提示框 
			$('[data-toggle="tooltip"]').tooltip();

			$('.toast').toast('show');

		});	
	</script>
</body>
</html>

<!-- 
	// CityBus 市區公車之路線資料
	// https://ptx.transportdata.tw/MOTC/v2/Bus/Route/City/Hsinchu?%24top=30&%24format=JSON

	// 市區公車路線班表資料(市區公車之班表及班距資料。一般市區公車班次較多時會採用【班距】式時刻表；班次較少時會採用【班表】式時刻表)
	// https://ptx.transportdata.tw/MOTC/v2/Bus/Schedule/City/Hsinchu?%24top=30&%24format=JSON




	// 新竹市立動物園110年度門票收入及入園人數統計表
	// https://odws.hccg.gov.tw/001/Upload/25/opendataback/9059/622/5a276a5a-19c0-4df5-b2c4-5fbf9500ede0.json

	// 新竹市動物園動物資料
	// https://odws.hccg.gov.tw/001/Upload/25/OpenData/9059/16/e394cc37-0684-4a3c-87c1-d7aa1e11851b.json 
-->
